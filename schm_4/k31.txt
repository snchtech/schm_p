–î–æ–±—Ä–µ üëç –î–æ–¥–∞–º–æ **—á—ñ—Ç–∫—É, —ñ–∑–æ–ª—å–æ–≤–∞–Ω—É –∫–Ω–æ–ø–∫—É –≤–º–∏–∫–∞–Ω–Ω—è / –≤–∏–º–∏–∫–∞–Ω–Ω—è —Å—ñ—Ç–∫–∏**, —Ç–∞–∫ —â–æ–± —Ü–µ –±—É–ª–æ:

* –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –¥–ª—è **Next.js 16 (App Router)**
* –±–µ–∑ ‚Äú–ø—Ä–æ—Ç—è–≥—É–≤–∞–Ω–Ω—è –ø—Ä–æ–ø—Å—ñ–≤‚Äù
* –∫–µ—Ä—É–≤–∞–ª–æ—Å—è —á–µ—Ä–µ–∑ **store**
* –ª–µ–≥–∫–æ —Ä–æ–∑—à–∏—Ä—é–≤–∞–ª–æ—Å—å (–≥–∞—Ä—è—á—ñ –∫–ª–∞–≤—ñ—à—ñ, —ñ–∫–æ–Ω–∫–∞, tooltip)

–ù–∏–∂—á–µ ‚Äî **–º—ñ–Ω—ñ–º–∞–ª—å–Ω—ñ —Ç–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ –∑–º—ñ–Ω–∏**, –±–µ–∑ –ø–µ—Ä–µ–ø–∏—Å—É–≤–∞–Ω–Ω—è –≤—Å—å–æ–≥–æ –∫–æ–¥—É.

---

# 1Ô∏è‚É£ Store: —Å—Ç–∞–Ω —Å—ñ—Ç–∫–∏ (—Ç–∏ –≤–∂–µ –º–∞–π–∂–µ –≥–æ—Ç–æ–≤–∏–π)

–£ —Ç–µ–±–µ **–≤–∂–µ —î** `showGrid` —É `editorStore.js`. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Å—è, —â–æ –≤—ñ–Ω –≤–∏–≥–ª—è–¥–∞—î —Ç–∞–∫:

```js
// store/editorStore.js
export const useEditorStore = create((set) => ({
  showGrid: true,

  toggleGrid: () =>
    set((state) => ({ showGrid: !state.showGrid })),

  // —ñ–Ω—à–µ...
}));
```

üëâ **–ö–ª—é—á–æ–≤–∏–π –º–æ–º–µ–Ω—Ç**: –æ–∫—Ä–µ–º–∞ action `toggleGrid`, –∞ –Ω–µ –ª–æ–≥—ñ–∫–∞ –≤ UI.

---

# 2Ô∏è‚É£ –û–∫—Ä–µ–º–∏–π UI-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–Ω–æ–ø–∫–∏ (–ø—Ä–∞–≤–∏–ª—å–Ω–æ)

‚ùå **–ù–ï** –ø—Ö–∞—Ç–∏ –∫–Ω–æ–ø–∫—É –ø—Ä—è–º–æ –≤ `EditorStage`
‚úÖ **–¢–ê–ö** ‚Äî –≤–∏–Ω–µ—Å—Ç–∏ –≤ `components/editor/ui/GridToggle.jsx`

### `components/editor/ui/GridToggle.jsx`

```jsx
"use client";
import React from "react";
import { useEditorStore } from "@/store/editorStore";

export default function GridToggle() {
  const showGrid = useEditorStore((s) => s.showGrid);
  const toggleGrid = useEditorStore((s) => s.toggleGrid);

  return (
    <button
      onClick={toggleGrid}
      title="–ü–æ–∫–∞–∑–∞—Ç–∏ / —Å—Ö–æ–≤–∞—Ç–∏ —Å—ñ—Ç–∫—É"
      style={{
        padding: "6px 10px",
        borderRadius: 6,
        border: "1px solid #ccc",
        background: showGrid ? "#e8f0ff" : "#fff",
        cursor: "pointer",
        fontSize: 13,
      }}
    >
      {showGrid ? "‚ñ¶ –°—ñ—Ç–∫–∞: ON" : "‚ñ¶ –°—ñ—Ç–∫–∞: OFF"}
    </button>
  );
}
```

üìå –¢–µ–ø–µ—Ä –∫–Ω–æ–ø–∫–∞ **–Ω—ñ—á–æ–≥–æ –Ω–µ –∑–Ω–∞—î** –ø—Ä–æ GridLayer ‚Äî –ª–∏—à–µ –ø—Ä–æ —Å—Ç–∞–Ω.

---

# 3Ô∏è‚É£ Toolbar: –ø—ñ–¥–∫–ª—é—á–∞—î–º–æ –∫–Ω–æ–ø–∫—É

### `components/editor/ui/EditorToolbar.jsx`

```jsx
"use client";
import React from "react";
import GridToggle from "./GridToggle";

export default function EditorToolbar() {
  return (
    <div
      style={{
        display: "flex",
        gap: 8,
        padding: 10,
        borderBottom: "1px solid #ddd",
        alignItems: "center",
        background: "#fff",
      }}
    >
      <GridToggle />

      {/* –¥–∞–ª—ñ –º–æ–∂–Ω–∞ –¥–æ–¥–∞–≤–∞—Ç–∏ */}
      {/* Zoom buttons */}
      {/* Undo / Redo */}
    </div>
  );
}
```

üëâ Toolbar —Ç–µ–ø–µ—Ä **–∫–æ–º–ø–æ–∑–∏—Ü—ñ–π–Ω–∏–π**, –∞ –Ω–µ ‚Äú–∑–Ω–∞—î –ø—Ä–æ –≤—Å–µ‚Äù.

---

# 4Ô∏è‚É£ EditorStage: —Ç—ñ–ª—å–∫–∏ —á–∏—Ç–∞—î showGrid

### `components/editor/stage/EditorStage.jsx`

–ó–º—ñ–Ω–∏ **–º—ñ–Ω—ñ–º–∞–ª—å–Ω—ñ** ‚Äî –Ω—ñ—á–æ–≥–æ –Ω–µ –∫–µ—Ä—É—î–º–æ —Ç—É—Ç.

```jsx
import { useEditorStore } from "@/store/editorStore";

// ...
const showGrid = useEditorStore((s) => s.showGrid);
const viewport = useEditorStore((s) => s.viewport);

// ...
<GridLayer
  width={stageSize.width}
  height={stageSize.height}
  viewport={viewport}
  visible={showGrid}
/>
```

‚ùó **EditorStage –Ω–µ –º–∞—î –∫–Ω–æ–ø–æ–∫ —ñ –ª–æ–≥—ñ–∫–∏ UI** ‚Äî —Ç—ñ–ª—å–∫–∏ —Ä–µ–Ω–¥–µ—Ä.

---

# 5Ô∏è‚É£ –†–µ–∑—É–ª—å—Ç–∞—Ç (—è–∫ —Ü–µ –ø—Ä–∞—Ü—é—î)

* –ö–Ω–æ–ø–∫–∞ ‚Üí `toggleGrid()`
* Store –∑–º—ñ–Ω—é—î `showGrid`
* `GridLayer` –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ:

  * –∞–±–æ —Ä–µ–Ω–¥–µ—Ä–∏—Ç—å—Å—è
  * –∞–±–æ –ø–æ–≤–µ—Ä—Ç–∞—î `null`
* –ù—ñ—è–∫–∏—Ö `props drilling`, –Ω—ñ—è–∫–∏—Ö `useEffect`

---

# 6Ô∏è‚É£ (–ë–æ–Ω—É—Å) –ì–∞—Ä—è—á—ñ –∫–ª–∞–≤—ñ—à—ñ ‚Äî 2 —Ä—è–¥–∫–∏

–Ø–∫—â–æ —Ö–æ—á–µ—à —è–∫ —É Visio (`G`):

```js
useEffect(() => {
  const onKey = (e) => {
    if (e.key.toLowerCase() === "g") {
      useEditorStore.getState().toggleGrid();
    }
  };
  window.addEventListener("keydown", onKey);
  return () => window.removeEventListener("keydown", onKey);
}, []);
```

üìå –ö—Ä–∞—â–µ –≤–∏–Ω–µ—Å—Ç–∏ –≤ `useEditorHotkeys.js`, –∞–ª–µ –ª–æ–≥—ñ–∫–∞ —Ç–∞ —Å–∞–º–∞.

---

# 7Ô∏è‚É£ –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–Ω–µ –ø—Ä–∞–≤–∏–ª–æ (–∑–∞–ø–∞–º‚Äô—è—Ç–∞—Ç–∏)

> **UI –∫–Ω–æ–ø–∫–∞ ‚Üí store ‚Üí —Ä–µ–Ω–¥–µ—Ä**
>
> ‚ùå UI ‚Üí –Ω–∞–ø—Ä—è–º—É –∫–µ—Ä—É—î GridLayer
> ‚ùå EditorStage –º—ñ—Å—Ç–∏—Ç—å –∫–Ω–æ–ø–∫–∏
> ‚úÖ UI –Ω–µ –∑–Ω–∞—î –ø—Ä–æ Konva
> ‚úÖ Konva –Ω–µ –∑–Ω–∞—î –ø—Ä–æ UI

---

–Ø–∫ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é:

* –¥–æ–¥–∞—Ç–∏ **Snap to grid (Shift)**
* –¥–æ–¥–∞—Ç–∏ **grid size selector (10 / 20 / 40)**
* –∞–±–æ –∑—Ä–æ–±–∏—Ç–∏ **–æ–∫—Ä–µ–º–∏–π LayerSettings popover**

–°–∫–∞–∂–∏, —â–æ —Ö–æ—á–µ—à –¥–∞–ª—ñ ‚Äî –ø—ñ–¥ —Ü–µ –æ–¥—Ä–∞–∑—É –¥–∞–º –ø—Ä–∞–≤–∏–ª—å–Ω—É —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—é üëå
