–û–∫ ‚úÖ –ù–∏–∂—á–µ ‚Äî **–≥–æ—Ç–æ–≤–∏–π MUI-–ø–∞–Ω–µ–ª—å–Ω–∏–π –±–ª–æ–∫** –¥–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å –ø—ñ–¥–ø–∏—Å—É, —è–∫–∏–π –º–æ–∂–Ω–∞ –≤—Å—Ç–∞–≤–∏—Ç–∏ –≤ —Ç–≤–æ—î –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–µ –º–µ–Ω—é / –ø—Ä–∞–≤—É –ø–∞–Ω–µ–ª—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤.

> –ü—ñ–¥—Ç—Ä–∏–º—É—î: **–Ω–∞–∑–≤–∞**, **–ø–æ–∫–∞–∑—É–≤–∞—Ç–∏/—Ö–æ–≤–∞—Ç–∏**, **–ø–æ–∑–∏—Ü—ñ—è** (top/bottom/left/right), **—Ä–æ–∑–º—ñ—Ä —à—Ä–∏—Ñ—Ç—É**, **–≤–∞–≥–∞** (light/regular/medium/bold), **–∫–æ–ª—ñ—Ä**, **–≤—ñ–¥—Å—Ç—É–ø**.

---

## 1) MUI-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç `LabelSettingsPanelMUI`

üìÅ `app/diagram/components/LabelSettingsPanelMUI.jsx`

```jsx
"use client";

import React, { useMemo } from "react";
import {
  Box,
  Stack,
  Typography,
  TextField,
  FormControlLabel,
  Checkbox,
  FormControl,
  InputLabel,
  Select,
  MenuItem,
  Slider,
  ToggleButtonGroup,
  ToggleButton,
  Divider,
} from "@mui/material";

const POSITIONS = [
  { value: "top", label: "–ó–≤–µ—Ä—Ö—É" },
  { value: "bottom", label: "–ó–Ω–∏–∑—É" },
  { value: "left", label: "–ó–ª—ñ–≤–∞" },
  { value: "right", label: "–°–ø—Ä–∞–≤–∞" },
];

const WEIGHTS = [
  { value: "light", label: "Light (300)" },
  { value: "regular", label: "Regular (400)" },
  { value: "medium", label: "Medium (500)" },
  { value: "bold", label: "Bold (700)" },
];

export default function LabelSettingsPanelMUI({
  element,         // –ø–æ—Ç–æ—á–Ω–∏–π –µ–ª–µ–º–µ–Ω—Ç (selected / contextMenu element)
  updateElement,   // (id, patch) => void
  dense = false,
}) {
  const label = element?.label || {};

  const disabledAll = !element;

  const setLabel = (patch) => {
    if (!element) return;
    updateElement(element.id, {
      label: { ...label, ...patch },
    });
  };

  const fontSize = Number.isFinite(label.fontSize) ? label.fontSize : 14;
  const offset = Number.isFinite(label.offset) ? label.offset : 6;

  const previewText = useMemo(() => {
    const t = (label.text ?? "").toString().trim();
    return t || "–ü—ñ–¥–ø–∏—Å";
  }, [label.text]);

  return (
    <Box sx={{ p: dense ? 1 : 2, width: 320 }}>
      <Stack spacing={dense ? 1 : 1.5}>
        <Stack spacing={0.5}>
          <Typography variant="subtitle1" sx={{ fontWeight: 700 }}>
            –ü—ñ–¥–ø–∏—Å –µ–ª–µ–º–µ–Ω—Ç–∞
          </Typography>
          <Typography variant="body2" color="text.secondary">
            –ù–∞–ª–∞—à—Ç—É–π –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ç–∞ —Å—Ç–∏–ª—å –Ω–∞–∑–≤–∏.
          </Typography>
        </Stack>

        <Divider />

        <TextField
          size="small"
          label="–ù–∞–∑–≤–∞"
          value={label.text ?? ""}
          disabled={disabledAll}
          onChange={(e) => setLabel({ text: e.target.value })}
          placeholder="–í–∫–∞–∂—ñ—Ç—å –Ω–∞–∑–≤—É –µ–ª–µ–º–µ–Ω—Ç–∞"
          fullWidth
        />

        <FormControlLabel
          disabled={disabledAll}
          control={
            <Checkbox
              checked={!!label.visible}
              onChange={(e) => setLabel({ visible: e.target.checked })}
            />
          }
          label="–í—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏ –ø—ñ–¥–ø–∏—Å"
        />

        <FormControl size="small" fullWidth disabled={disabledAll}>
          <InputLabel id="label-position">–ü–æ–∑–∏—Ü—ñ—è</InputLabel>
          <Select
            labelId="label-position"
            label="–ü–æ–∑–∏—Ü—ñ—è"
            value={label.position || "top"}
            onChange={(e) => setLabel({ position: e.target.value })}
          >
            {POSITIONS.map((p) => (
              <MenuItem key={p.value} value={p.value}>
                {p.label}
              </MenuItem>
            ))}
          </Select>
        </FormControl>

        <FormControl size="small" fullWidth disabled={disabledAll}>
          <InputLabel id="label-weight">–í–∞–≥–∞ —à—Ä–∏—Ñ—Ç—É</InputLabel>
          <Select
            labelId="label-weight"
            label="–í–∞–≥–∞ —à—Ä–∏—Ñ—Ç—É"
            value={label.fontWeight || "regular"}
            onChange={(e) => setLabel({ fontWeight: e.target.value })}
          >
            {WEIGHTS.map((w) => (
              <MenuItem key={w.value} value={w.value}>
                {w.label}
              </MenuItem>
            ))}
          </Select>
        </FormControl>

        <Stack spacing={0.5}>
          <Typography variant="body2" sx={{ fontWeight: 600 }}>
            –†–æ–∑–º—ñ—Ä —Ç–µ–∫—Å—Ç—É: {fontSize}px
          </Typography>
          <Slider
            value={fontSize}
            min={6}
            max={72}
            step={1}
            disabled={disabledAll}
            onChange={(_, v) => setLabel({ fontSize: v })}
          />
        </Stack>

        <Stack spacing={0.5}>
          <Typography variant="body2" sx={{ fontWeight: 600 }}>
            –í—ñ–¥—Å—Ç—É–ø –≤—ñ–¥ –µ–ª–µ–º–µ–Ω—Ç–∞: {offset}px
          </Typography>
          <Slider
            value={offset}
            min={0}
            max={40}
            step={1}
            disabled={disabledAll}
            onChange={(_, v) => setLabel({ offset: v })}
          />
        </Stack>

        <Stack direction="row" spacing={1} alignItems="center">
          <TextField
            size="small"
            label="–ö–æ–ª—ñ—Ä"
            type="color"
            value={label.color || "#000000"}
            disabled={disabledAll}
            onChange={(e) => setLabel({ color: e.target.value })}
            sx={{
              width: 110,
              "& input": { padding: "8px 10px", height: 24 },
            }}
          />
          <Box sx={{ flex: 1 }}>
            <Typography variant="caption" color="text.secondary">
              Preview
            </Typography>
            <Typography
              variant="body1"
              sx={{
                fontFamily: label.fontFamily || "Inter",
                fontWeight:
                  label.fontWeight === "bold"
                    ? 700
                    : label.fontWeight === "medium"
                      ? 500
                      : label.fontWeight === "light"
                        ? 300
                        : 400,
                color: label.color || "#000",
                border: "1px solid",
                borderColor: "divider",
                borderRadius: 1,
                px: 1,
                py: 0.5,
                display: "inline-block",
              }}
            >
              {previewText}
            </Typography>
          </Box>
        </Stack>

        <Divider />

        {/* –û–ø—Ü—ñ–π–Ω–æ: —à–≤–∏–¥–∫—ñ –∫–Ω–æ–ø–∫–∏ –ø–æ–∑–∏—Ü—ñ—ó (–∑—Ä—É—á–Ω–æ) */}
        <Stack spacing={0.5}>
          <Typography variant="body2" sx={{ fontWeight: 600 }}>
            –®–≤–∏–¥–∫–µ –ø–æ–∑–∏—Ü—ñ—é–≤–∞–Ω–Ω—è
          </Typography>
          <ToggleButtonGroup
            exclusive
            size="small"
            value={label.position || "top"}
            disabled={disabledAll}
            onChange={(_, v) => {
              if (!v) return;
              setLabel({ position: v });
            }}
            fullWidth
          >
            <ToggleButton value="top">Top</ToggleButton>
            <ToggleButton value="bottom">Bottom</ToggleButton>
            <ToggleButton value="left">Left</ToggleButton>
            <ToggleButton value="right">Right</ToggleButton>
          </ToggleButtonGroup>
        </Stack>
      </Stack>
    </Box>
  );
}
```

---

## 2) –Ø–∫ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–µ –º–µ–Ω—é (MUI Menu/Popover)

–Ø–∫—â–æ —Ç–∏ –≤—ñ–¥–∫—Ä–∏–≤–∞—î—à –º–µ–Ω—é –ø–æ –ü–ö–ú —ñ –º–∞—î—à `contextMenu = {open,x,y,elementId}`, —Ç–æ –ø—Ä–∏–∫–ª–∞–¥ –∑ `Popover`:

```jsx
import { Popover } from "@mui/material";
import LabelSettingsPanelMUI from "@/app/diagram/components/LabelSettingsPanelMUI";

export default function DiagramContextPopover({
  contextMenu,
  closeMenu,
  symbols,
  updateElement,
}) {
  const element = symbols.find((x) => x.id === contextMenu.elementId) || null;

  return (
    <Popover
      open={!!contextMenu.open}
      onClose={closeMenu}
      anchorReference="anchorPosition"
      anchorPosition={
        contextMenu.open ? { top: contextMenu.y, left: contextMenu.x } : undefined
      }
      PaperProps={{ sx: { borderRadius: 2 } }}
    >
      <LabelSettingsPanelMUI
        element={element}
        updateElement={updateElement}
      />
    </Popover>
  );
}
```

---

## 3) –í–∞–∂–ª–∏–≤–µ: —à—Ä–∏—Ñ—Ç ‚Äú–≤—É–∑—å–∫–∏–π‚Äù + –≤–∞–≥–∏

–©–æ–± —Ä–µ–∞–ª—å–Ω–æ –±—É–ª–∏ **light/regular/medium/bold**, –ø—ñ–¥–∫–ª—é—á–∏ —à—Ä–∏—Ñ—Ç –∑ –≤–∞–≥–∞–º–∏.

–ù–∞–ø—Ä., **Inter**:

```html
<link
  href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;700&display=swap"
  rel="stylesheet"
/>
```

–Ø–∫—â–æ —Ö–æ—á–µ—à **—Å–∞–º–µ –≤—É–∑—å–∫–∏–π (condensed)** ‚Äî –±–µ—Ä–∏ Roboto Condensed:

```html
<link
  href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:wght@300;400;500;700&display=swap"
  rel="stylesheet"
/>
```

–Ü –≤ `label.fontFamily` —Å—Ç–∞–≤ `"Roboto Condensed"`.

---

## 4) –ù–∞–≥–∞–¥—É–≤–∞–Ω–Ω—è: LabelText –º–∞—î —á–∏—Ç–∞—Ç–∏ offset

–ü–µ—Ä–µ–≤—ñ—Ä, —â–æ —É —Ç–≤–æ—î–º—É `LabelText` –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è `label.offset` (–≤ –º–æ—ó–π —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó ‚Äî —Ç–∞–∫).

---

–Ø–∫—â–æ —Ç–∏ –ø–æ–∫–∞–∂–µ—à, **–¥–µ —Å–∞–º–µ —É —Ç–µ–±–µ –∑–∞—Ä–∞–∑ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∏–π menu (MUI Menu —á–∏ —Å–∞–º–æ–ø–∏—Å–Ω–∏–π div)**, —è –æ–¥—Ä–∞–∑—É –ø—ñ–¥–∂–µ–Ω—É –∫–æ–¥ 1-–≤-1 –ø—ñ–¥ —Ç–≤–æ—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É (–±–µ–∑ –∑–∞–π–≤–∏—Ö –ø–µ—Ä–µ—Ä–æ–±–æ–∫).
